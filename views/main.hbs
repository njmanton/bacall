<div class="content container-fluid">
  <div class="row">
    <div class="">
      <p>Welcome to the 11th annual My 20 Year Oscar Hell competition!</p>
      <div id="salutation">
        <p>Hi <span class="username"></span>, you can make or amend your predictions <a href="" id="pred_url">here</a>. <span class="small">(<a href="#" id="change_user">Not you?</a>)</span>
      </div>
      <p>This year, to celebrate cinema's greatest accidental double-bill, you can toggle your preferred Barbenheimer experience by clicking on the button in the footer below.</p>
      <h4>How it works</h4>
      <ol>
        <li>Complete the form below to receive a unique <code>code</code> by email</li> 
        <li>Go to your predictions page (e.g. <code>https://oscars.mxxyqh.com/player/CODE</code>)</li>
        <li>Pick a winner for each of the 23 categories</li>
      </ol>
    </div>
    <div class="signup">
      <div class="alert alert-danger" role="alert">
        <p>Please be aware there is currently an issue with the server sending emails. You can register as normal and use the code and link provided at the top of the screen, but emails are not currently being sent. I'm working with the mail provider to fix it and will email directly anyone affected - sorry about this ðŸ˜«</p>
      </div>
    {{>signup }}
    </div>
  </div>
</div>
<script>
  
  check_ls();
  function check_ls() {
  if (localStorage.getItem('user_code') && localStorage.getItem('user')) {
    $('#salutation').show();
    var url = `/player/${ localStorage.getItem('user_code') }/1`;
    $('.username').text(localStorage.getItem('user'));
    $('#pred_url').prop('href', url);
  } else {
    $('#salutation').hide();
  };    
  }

 document.getElementById('change_user').addEventListener('click', async (e) => {
    e.preventDefault(); 
    if (window.confirm('Are you sure?')) {
      localStorage.removeItem('user');
      localStorage.removeItem('user_code');
      check_ls();
    }
  });
</script>